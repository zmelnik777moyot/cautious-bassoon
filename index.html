<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NFT –†—É–ª–µ—Ç–∫–∞</title>
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      background: #121212;
      color: white;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .container {
      padding: 20px;
      max-width: 400px;
      width: 100%;
    }
    .card {
      background: #1e1e1e;
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    button {
      background: #2a85ff;
      border: none;
      border-radius: 12px;
      color: white;
      padding: 12px 20px;
      margin: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    .hidden {
      display: none;
    }
    .balance {
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <div id="ton-connect"></div>
    <div class="balance" id="balance">–ë–∞–ª–∞–Ω—Å: ‚Äî</div>

    <!-- –õ–æ–±–±–∏ -->
    <div class="card" id="lobby">
      <h2>üé∞ NFT –†—É–ª–µ—Ç–∫–∞</h2>
      <p>–í—ã–±–µ—Ä–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏–Ω–æ–≤:</p>
      <div>
        <button onclick="selectSpins(1)">1 –°–ø–∏–Ω</button>
        <button onclick="selectSpins(3)">3 –°–ø–∏–Ω–∞</button>
        <button onclick="selectSpins(5)">5 –°–ø–∏–Ω–æ–≤</button>
      </div>
      <p id="spinsSelected">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</p>
      <button onclick="startGame()">–ò–≥—Ä–∞—Ç—å</button>
    </div>

    <!-- –†—É–ª–µ—Ç–∫–∞ -->
    <div class="card hidden" id="roulette">
      <h3>–°–ø–∏–Ω–æ–≤ –æ—Å—Ç–∞–ª–æ—Å—å: <span id="spinsLeft"></span></h3>
      <p>üé° –ö—Ä—É—Ç–∏–º —Ä—É–ª–µ—Ç–∫—É...</p>
      <button onclick="spin()">–ö—Ä—É—Ç–∏—Ç—å</button>
      <p id="result"></p>
    </div>
  </div>

  <script>
    let spins = 0;
    let spinsLeft = 0;

    const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
      manifestUrl: 'https://gamenft.ru/tonconnect-manifest.json', // –∑–∞–º–µ–Ω–∏—à—å –ø–æ–∑–∂–µ
      buttonRootId: 'ton-connect'
    });

    async function updateBalance() {
      const connectedWallet = await tonConnectUI.wallet;
      if (!connectedWallet) return;

      const address = connectedWallet.account.address;
      try {
        const res = await fetch(`https://tonapi.io/v1/account/${address}`);
        const data = await res.json();
        const balanceTON = data.balance / 1e9;
        document.getElementById('balance').innerText = `–ë–∞–ª–∞–Ω—Å: ${balanceTON.toFixed(2)} TON`;
      } catch (err) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –±–∞–ª–∞–Ω—Å–∞', err);
      }
    }

    tonConnectUI.onStatusChange(async wallet => {
      if (wallet) {
        await updateBalance();
      } else {
        document.getElementById('balance').innerText = '–ë–∞–ª–∞–Ω—Å: ‚Äî';
      }
    });

    function selectSpins(count) {
      spins = count;
      document.getElementById('spinsSelected').innerText = `–í—ã–±—Ä–∞–Ω–æ: ${count}`;
    }

    function startGame() {
      if (spins === 0) {
        alert('–í—ã–±–µ—Ä–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–∏–Ω–æ–≤!');
        return;
      }
      spinsLeft = spins;
      document.getElementById('lobby').classList.add('hidden');
      document.getElementById('roulette').classList.remove('hidden');
      document.getElementById('spinsLeft').innerText = spinsLeft;
    }

    function spin() {
      if (spinsLeft <= 0) return;

      const prizes = ['üî• NFT', 'üéÅ –ü–æ–¥–∞—Ä–æ–∫', 'üíé –ù–∏—á–µ–≥–æ', 'üöÄ –ë–æ–Ω—É—Å', 'üê± –ú–µ–º NFT'];
      const result = prizes[Math.floor(Math.random() * prizes.length)];

      document.getElementById('result').innerText = `–í—ã–ø–∞–ª–æ: ${result}`;
      spinsLeft -= 1;
      document.getElementById('spinsLeft').innerText = spinsLeft;

      if (spinsLeft === 0) {
        alert('–í—Å–µ —Å–ø–∏–Ω—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å!');
        document.getElementById('result').innerText += '\n–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞.';
      }
    }
  </script>
</body>
</html>